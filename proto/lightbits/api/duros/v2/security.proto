syntax = "proto3";

package lightbits.api.duros.v2;

option go_package = "duros/v2;v2";

import "lightbits/api/duros/v2/labels.proto";


message TrustedHost {
    //
    // Unique name identifying the trusted host.
    string name = 1;
    //
    // Project this host belongs to.
    string projectName = 2;
    //
    // Unique identifier of the trusted host (internally generated by Lightbits cluster).
    string UUID = 3;
    //
    // Host NQN (NVMe Qualified Name) of the trusted host.
    string hostNqn = 4;
    //
    // Optional. Labels to associate with the trusted host.
    repeated Label labels = 5;
}


message CreateTrustedHostRequest{
    //
    // Unique name identifying the trusted host to create.
    string name = 1;
    //
    // Project this trusted host belongs to.
    string projectName = 2;
    //
    // Host NQN (NVMe Qualified Name) of the trusted host.
    string hostNqn = 3;
    //
    // Optional. Labels to associate with the trusted host.
    repeated Label labels = 4;
}

message DeleteTrustedHostRequest {
    //
    // Name of the trusted host to delete (required to identify resource to delete).
    string name = 1;
    //
    // Project this trusted host belongs to (required to identify resource to delete).
    string projectName = 2;
}

message DeleteTrustedHostResponse {
}

message GetTrustedHostRequest {
    //
    // Name of the trusted host to get (required to identify resource to get).
    string name = 1;
    //
    // Project this trusted host belongs to (required to identify resource to get).
    string projectName = 2;
}


message UpdateTrustedHostRequest {
    //
    // Name of the trusted host to update (required to identify resource to update).
    string name = 1;
    //
    // Project this trusted host belongs to (required to identify resource to update).
    string projectName = 2;
    //
    // Host NQN (NVMe Qualified Name) of the trusted host to update. Currently update of hostNqn is not supported.
    string hostNqn = 3;
    //
    // Optional. Labels to associate with the trusted host.
    repeated Label labels = 4;
}


message ListTrustedHostsRequest {
    //
    // Optional. When specified returns only trusted hosts that belong to the specified project.
    string projectName = 1;
    //
    // Optional. When specified returns only trusted hosts that have the provided labels. Not currently supported.
    repeated Label labels = 2;
    //
    // Optional. When specified returns a list that starts a trusted host with a UUID equal to offsetUUID. Not currently supported.
    string offsetUUID = 3;
    //
    // Optional. Limits the number of trusted hosts in the response. Not currently supported.
    int64 limit = 4;
}

message ListTrustedHostsResponse {
    //
    // List of trusted hosts.
    repeated TrustedHost hosts = 1;
    //
    // If the response contains more hosts than the limit, the nextOffset will be returned. Currently this is not supported.
    string nextOffset = 2;
}

enum TargetSecretType {
    //
    // Disabled, Lightbits cluster may connect to trusted host without any secret.
    Disabled = 0;
    //
    // Enabled, Lightbits cluster must have a target secret specified to connect to a trusted host.
    Enabled = 1;
    //
    // Auto generated secret. Lightbits cluster will automatically generate a target secret and use this when connecting to the trusted host.
    AutoGenSecret = 2;
}


message SetTrustedHostSecretsRequest {
    //
    // Name of the trusted host to set secrets for.
    string name = 1;
    //
    // Project name of the trusted host to set secrets for.
    string projectName = 2;
    //
    // A trusted host secret to allow trusted connection from a host to the NVMe target (Lightbits cluster).
    bytes hostSecret = 3;
    //
    // A target secret to allow trusted connection from a NVMe target (Lightbits cluster) to a host.
    bytes targetSecret = 4;
    //
    // Type of target secret to set Disabled (default)/ Enabled/ AutoGenSecret.
    TargetSecretType targetSecretType = 5;
}

message SetTrustedHostSecretsResponse {
}

message GetTrustedHostSecretsRequest {
    //
    // Name of the trusted host to get secrets for.
    string name = 1;
    //
    // Project name of the trusted host to get secrets for.
    string projectName = 2;
}


message GetTrustedHostSecretsResponse {
    //
    // Configuration of info for the trusted host.
    TrustedHost host = 1;
    //
    // A host secret to allow trusted connection from a host to the NVMe target (Lightbits cluster).
    bytes hostSecret = 2;
    //
    // A target secret to allow trusted connection from a NVMe target (Lightbits cluster) to a host.
    bytes targetSecret = 3;
    //
    // Type of target secret to set Disabled (default)/ Enabled/ AutoGenSecret.
    TargetSecretType targetSecretType = 4;
}

message EnableClusterInBandAuthRequest {
    //
    // Name of the subsystem NQN to enable in-band authentication for. If not specified cluster level will be assumed. Currently only supported for the default subsystem: DefaultSubSystem.
    string subsystemNqnName = 1;
}

message DisableClusterInBandAuthRequest {
    //
    // Name of the subsystem NQN to disable in-band authentication for. If not specified cluster level will be assumed. Currently only supported for the default subsystem: DefaultSubSystem.
    string subsystemNqnName = 1;
}

message EnableClusterInBandAuthResponse{
}

message DisableClusterInBandAuthResponse {
}
